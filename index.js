(function() {
  var PouchDB, crypto, debug, delay, pkg, replicate, seem, sleep, url,
    hasProp = {}.hasOwnProperty;

  seem = require('seem');

  delay = 2000;

  module.exports = replicate = seem(function*(prefix_source, prefix_target, name, extensions_cb) {
    var _rev, auth, comment, doc, id, k, model, replicator, replicator_db, source, sum, target, use_delete, v;
    replicator_db = prefix_target + "/_replicator";
    replicator = new PouchDB(replicator_db, {
      skip_setup: true
    });
    use_delete = true;
    source = url.parse(prefix_source);
    target = url.parse(prefix_target);
    comment = "replication of " + name + " from " + source.host;
    debug("Going to start " + comment + ".");
    model = {
      comment: comment,
      continuous: true,
      target: {
        url: url.format({
          protocol: target.protocol,
          host: target.host,
          pathname: name
        })
      },
      source: {
        url: url.format({
          protocol: source.protocol,
          host: source.host,
          pathname: name
        })
      }
    };
    if (source.auth != null) {
      auth = (new Buffer(source.auth)).toString('base64');
      debug("Encoded `" + source.auth + "` of `" + prefix_source + "` as `" + auth + "`.");
      model.source.headers = {
        Authorization: "Basic " + auth
      };
    }
    if (target.auth != null) {
      auth = (new Buffer(target.auth)).toString('base64');
      debug("Encoded `" + target.auth + "` of `" + prefix_target + "` as `" + auth + "`.");
      model.target.headers = {
        Authorization: "Basic " + auth
      };
    }
    yield (typeof extensions_cb === "function" ? extensions_cb(model) : void 0);
    sum = crypto.createHash('sha256');
    sum.update(JSON.stringify(model));
    id = sum.digest('hex');
    model.comment_id = id;
    model._id = use_delete ? model.comment : id;
    debug("Going to inject", model);
    target = new PouchDB(prefix_target + "/" + name, {
      skip_setup: false
    });
    yield target.info();
    target.close();
    if (use_delete) {
      _rev = (yield replicator.get(model._id)["catch"](function(error) {
        return {};
      }))._rev;
      if (_rev != null) {
        yield replicator.remove(model._id, _rev);
      }
    }
    yield sleep(delay);
    _rev = (yield replicator.get(model._id)["catch"](function(error) {
      return {};
    }))._rev;
    doc = {};
    if (_rev != null) {
      doc._rev = _rev;
    }
    for (k in model) {
      if (!hasProp.call(model, k)) continue;
      v = model[k];
      doc[k] = v;
    }
    debug('Creating replication', doc);
    yield replicator.put(doc)["catch"](function(error) {
      debug.error("put " + model._id, error);
      if ((error.status != null) && error.status === 403) {
        debug("Replication already started");
        return;
      }
      debug.error("Replication from " + model.source + " failed.", error);
      return Promise.reject(error);
    });
    yield sleep(delay);
    doc = (yield replicator.get(model._id)["catch"](function(error) {
      return {};
    }));
    debug('Replication status', doc);
    replicator.close();
  });

  PouchDB = require('ccnq4-pouchdb').plugin(require('pouchdb-replication'));

  sleep = function(timeout) {
    return new Promise(function(resolve) {
      return setTimeout(resolve, timeout);
    });
  };

  crypto = require('crypto');

  url = require('url');

  pkg = require('./package.json');

  debug = (require('tangible'))(pkg.name);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC5jb2ZmZWUubWQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0k7QUFBQSxNQUFBLCtEQUFBO0lBQUE7O0VBQUEsSUFBQSxHQUFPLE9BQUEsQ0FBUSxNQUFSOztFQUVQLEtBQUEsR0FBUTs7RUFNUixNQUFNLENBQUMsT0FBUCxHQUFpQixTQUFBLEdBQVksSUFBQSxDQUFLLFVBQUMsYUFBRCxFQUFlLGFBQWYsRUFBNkIsSUFBN0IsRUFBa0MsYUFBbEM7QUFFaEMsUUFBQTtJQUFBLGFBQUEsR0FBbUIsYUFBRCxHQUFlO0lBQ2pDLFVBQUEsR0FBYSxJQUFJLE9BQUosQ0FBWSxhQUFaLEVBQTJCO01BQUEsVUFBQSxFQUFZLElBQVo7S0FBM0I7SUFLYixVQUFBLEdBQWE7SUFTYixNQUFBLEdBQVMsR0FBRyxDQUFDLEtBQUosQ0FBVSxhQUFWO0lBQ1QsTUFBQSxHQUFTLEdBQUcsQ0FBQyxLQUFKLENBQVUsYUFBVjtJQUNULE9BQUEsR0FBVSxpQkFBQSxHQUFrQixJQUFsQixHQUF1QixRQUF2QixHQUErQixNQUFNLENBQUM7SUFDaEQsS0FBQSxDQUFNLGlCQUFBLEdBQWtCLE9BQWxCLEdBQTBCLEdBQWhDO0lBSUEsS0FBQSxHQUNFO01BQUEsT0FBQSxFQUFTLE9BQVQ7TUFDQSxVQUFBLEVBQVksSUFEWjtNQUtBLE1BQUEsRUFDRTtRQUFBLEdBQUEsRUFBSyxHQUFHLENBQUMsTUFBSixDQUNIO1VBQUEsUUFBQSxFQUFVLE1BQU0sQ0FBQyxRQUFqQjtVQUNBLElBQUEsRUFBTSxNQUFNLENBQUMsSUFEYjtVQUVBLFFBQUEsRUFBVSxJQUZWO1NBREcsQ0FBTDtPQU5GO01BVUEsTUFBQSxFQUNFO1FBQUEsR0FBQSxFQUFLLEdBQUcsQ0FBQyxNQUFKLENBQ0g7VUFBQSxRQUFBLEVBQVUsTUFBTSxDQUFDLFFBQWpCO1VBQ0EsSUFBQSxFQUFNLE1BQU0sQ0FBQyxJQURiO1VBRUEsUUFBQSxFQUFVLElB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O0lBWkssQ0FGSDtJQWtCTixNQUFNLEtBQUEsQ0FBTSxLQUFOO0lBSU4sR0FBQSxHQUFNLENBQUEsTUFBTSxVQUNWLENBQUMsR0FEUyxDQUNMLEtBQUssQ0FBQyxHQURELENBRVYsRUFBQyxLQUFELEVBRlUsQ0FFSCxTQUFDLEtBQUQ7YUFBVztJQUFYLENBRkcsQ0FBTjtJQUlOLEtBQUEsQ0FBTSxvQkFBTixFQUE0QixHQUE1QjtJQUNBLFVBQVUsQ0FBQyxLQUFYLENBQUE7RUF2SWdDLENBQUw7O0VBNkk3QixPQUFBLEdBQVUsT0FBQSxDQUFRLGVBQVIsQ0FDUixDQUFDLE1BRE8sQ0FDQSxPQUFBLENBQVEscUJBQVIsQ0FEQTs7RUFHVixLQUFBLEdBQVEsU0FBQyxPQUFEO1dBQWEsSUFBSSxPQUFKLENBQVksU0FBQyxPQUFEO2FBQWEsVUFBQSxDQUFXLE9BQVgsRUFBb0IsT0FBcEI7SUFBYixDQUFaO0VBQWI7O0VBQ1IsTUFBQSxHQUFTLE9BQUEsQ0FBUSxRQUFSOztFQUNULEdBQUEsR0FBTSxPQUFBLENBQVEsS0FBUjs7RUFDTixHQUFBLEdBQU0sT0FBQSxDQUFRLGdCQUFSOztFQUNOLEtBQUEsR0FBUSxDQUFDLE9BQUEsQ0FBUSxVQUFSLENBQUQsQ0FBQSxDQUFxQixHQUFHLENBQUMsSUFBekI7QUE1SlIiLCJzb3VyY2VzQ29udGVudCI6WyJgcmVwbGljYXRlYFxuLS0tLS0tLS0tLS1cblxuICAgIHNlZW0gPSByZXF1aXJlICdzZWVtJ1xuXG4gICAgZGVsYXkgPSAyMDAwXG5cbmByZXBsaWNhdGUoc291cmNlLHRhcmdldCxuYW1lLGV4dGVuc2lvbnMpYDogcmVwbGljYXRlIGRhdGFiYXNlIGBuYW1lYCBmcm9tIGBzb3VyY2VgIHRvIGB0YXJnZXRgIChhbGwgc3RyaW5ncykgYnkgY3JlYXRpbmcgYSByZXBsaWNhdGlvbiBgcHVsbGAgZG9jdW1lbnQgb24gdGhlIHRhcmdldC5cbkJlZm9yZSBzdWJtaXNzaW9uLCB0aGUgcmVwbGljYXRpb24gZG9jdW1lbnQgaXMgcGFzc2VkIHRvIHRoZSAob3B0aW9uYWwpIGBleHRlbnNpb25zYCBjYWxsYmFjay5cblJldHVybnMgYSBQcm9taXNlLiBNYWtlIHN1cmUgeW91IGBjYXRjaCgpYCBhbnkgZXJyb3JzLlxuXG4gICAgbW9kdWxlLmV4cG9ydHMgPSByZXBsaWNhdGUgPSBzZWVtIChwcmVmaXhfc291cmNlLHByZWZpeF90YXJnZXQsbmFtZSxleHRlbnNpb25zX2NiKSAtPlxuXG4gICAgICByZXBsaWNhdG9yX2RiID0gXCIje3ByZWZpeF90YXJnZXR9L19yZXBsaWNhdG9yXCJcbiAgICAgIHJlcGxpY2F0b3IgPSBuZXcgUG91Y2hEQiByZXBsaWNhdG9yX2RiLCBza2lwX3NldHVwOiB0cnVlXG5cbkhlcmUgd2UgaGF2ZSBtdWx0aXBsZSBzb2x1dGlvbnMsIHNvIEknbGwgdGVzdCB0aGVtOlxuLSBlaXRoZXIgZGVsZXRlIGFueSBleGlzdGluZyBkb2N1bWVudCB3aXRoIHRoZSBzYW1lIG5hbWUgKHRoaXMgc2hvdWxkIGNhbmNlbCB0aGUgcmVwbGljYXRpb24sIGJhc2VkIG9uIHRoZSBDb3VjaERCIGRvY3MpLCBhbmQgcmVjcmVhdGUgYSBuZXcgb25lO1xuXG4gICAgICB1c2VfZGVsZXRlID0gdHJ1ZVxuXG4tIG9yIHVzZSBhIGRpZmZlcmVudCBJRCBmb3IgZG9jdW1lbnRzIHRoYXQgZGVzY3JpYmVzIGRpZmZlcmVudCByZXBsaWNhdGlvbnMuXG5cbiAgICAgICMgdXNlX2RlbGV0ZSA9IGZhbHNlXG5cblRoZSBvbmUgdGhpbmcgd2Uga25vdyBkb2Vzbid0IHdvcmsgaXMgdXNpbmcgdGhlIHNhbWUgZG9jdW1lbnQgSUQgZm9yIGRvY3VtZW50cyB0aGF0IGRlc2NyaWJlIGRpZmZlcmVudCByZXBsaWNhdGlvbnMgKGUuZy4gd2l0aCBkaWZmZXJlbnQgZmlsdGVyczogZXhwZXJpZW5jZSBzaG93cyB0aGUgcmVwbGljYXRvciBkb2Vzbid0IG5vdGljZSBhbmQga2VlcHMgdXNpbmcgdGhlIG9sZCBmaWx0ZXIpLlxuRGVsZXRpbmcgdGhlIHJlcGxpY2F0aW9uIGRvY3VtZW50IHNob3VsZCBhbHNvIGZvcmNlIHRoZSByZXBsaWNhdG9yIHRvIHN0b3AgdGhlIGV4aXN0aW5nIHJlcGxpY2F0aW9uIGFuZCBzdGFydCBhIG5ldyBwcm9jZXNzLlxuXG4gICAgICBzb3VyY2UgPSB1cmwucGFyc2UgcHJlZml4X3NvdXJjZVxuICAgICAgdGFyZ2V0ID0gdXJsLnBhcnNlIHByZWZpeF90YXJnZXRcbiAgICAgIGNvbW1lbnQgPSBcInJlcGxpY2F0aW9uIG9mICN7bmFtZX0gZnJvbSAje3NvdXJjZS5ob3N0fVwiXG4gICAgICBkZWJ1ZyBcIkdvaW5nIHRvIHN0YXJ0ICN7Y29tbWVudH0uXCJcblxuSSdtIGNyZWF0aW5nIGEgYG1vZGVsYCBkb2N1bWVudC4uIGp1c3QgaW4gY2FzZSBJJ2QgaGF2ZSB0byByZXZlcnQgdG8gbWFudWFsbHkgcHVzaGluZyB0byBgL19yZXBsaWNhdGVgIGJlY2F1c2UgdGhlIHJlcGxpY2F0b3IgaXMgdG9vIGJyb2tlbi4gOilcblxuICAgICAgbW9kZWwgPVxuICAgICAgICBjb21tZW50OiBjb21tZW50XG4gICAgICAgIGNvbnRpbnVvdXM6IHRydWVcblxuUmVtb3ZlIGF1dGhvcml6YXRpb24gZnJvbSB0aGUgc291cmNlIGFuZCB0YXJnZXQsIGJlY2F1c2UuLi5cblxuICAgICAgICB0YXJnZXQ6XG4gICAgICAgICAgdXJsOiB1cmwuZm9ybWF0XG4gICAgICAgICAgICBwcm90b2NvbDogdGFyZ2V0LnByb3RvY29sXG4gICAgICAgICAgICBob3N0OiB0YXJnZXQuaG9zdFxuICAgICAgICAgICAgcGF0aG5hbWU6IG5hbWVcbiAgICAgICAgc291cmNlOlxuICAgICAgICAgIHVybDogdXJsLmZvcm1hdFxuICAgICAgICAgICAgcHJvdG9jb2w6IHNvdXJjZS5wcm90b2NvbFxuICAgICAgICAgICAgaG9zdDogc291cmNlLmhvc3RcbiAgICAgICAgICAgIHBhdGhuYW1lOiBuYW1lXG5cbi4uLmV2ZW4gd2l0aCBDb3VjaERCIH5+MS42LjF+fiAyLjEuMSB3ZSBzdGlsbCBoYXZlIHRoZSBpc3N1ZSB3aXRoIENvdWNoREIgbm90IHByb3Blcmx5IG1hbmFnaW5nIGF1dGhvcml6YXRpb24gaGVhZGVycyB3aGVuIGEgdXNlcm5hbWUgYW5kIHBhc3N3b3JkIGFyZSBwcm92aWRlZCBpbiB0aGUgb3JpZ2luYWwgVVJJIHRoYXQgY29udGFpbnMgXCJzcGVjaWFsXCIgY2hhcmFjdGVycyAobGlrZSBgQGAgb3Igc3BhY2UpLiBTbyBsZXQncyBoYW5kbGUgaXQgb3Vyc2VsdmVzLlxuXG4gICAgICBpZiBzb3VyY2UuYXV0aD9cbiAgICAgICAgYXV0aCA9IChuZXcgQnVmZmVyIHNvdXJjZS5hdXRoKS50b1N0cmluZyAnYmFzZTY0J1xuICAgICAgICBkZWJ1ZyBcIkVuY29kZWQgYCN7c291cmNlLmF1dGh9YCBvZiBgI3twcmVmaXhfc291cmNlfWAgYXMgYCN7YXV0aH1gLlwiXG4gICAgICAgIG1vZGVsLnNvdXJjZS5oZWFkZXJzID1cbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBcIkJhc2ljICN7YXV0aH1cIlxuXG4gICAgICBpZiB0YXJnZXQuYXV0aD9cbiAgICAgICAgYXV0aCA9IChuZXcgQnVmZmVyIHRhcmdldC5hdXRoKS50b1N0cmluZyAnYmFzZTY0J1xuICAgICAgICBkZWJ1ZyBcIkVuY29kZWQgYCN7dGFyZ2V0LmF1dGh9YCBvZiBgI3twcmVmaXhfdGFyZ2V0fWAgYXMgYCN7YXV0aH1gLlwiXG4gICAgICAgIG1vZGVsLnRhcmdldC5oZWFkZXJzID1cbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBcIkJhc2ljICN7YXV0aH1cIlxuXG5MZXQgdGhlIGNhbGxiYWNrIGFkZCBhbnkgZmllbGQgdGhleSdkIGxpa2UuXG5Ob3RlOiB0aGUgY2FsbGJhY2sgbWlnaHQgYWxzbyBwcmV2ZW50IHJlcGxpY2F0aW9uIGlmIGl0IHRocm93cy4gVGhpcyBpcyBpbnRlbnRpb25hbC5cbk5vdGU6IHRoZSBjYWxsYmFjayBtaWdodCByZXR1cm4gYSBQcm9taXNlLiBPciBub3QuIFdlJ2xsIGRlYWwgd2l0aCBib3RoLlxuXG4gICAgICB5aWVsZCBleHRlbnNpb25zX2NiPyBtb2RlbFxuXG5DcmVhdGUgYSAoc29tZXdoYXQpIHVuaXF1ZSBJRCBmb3IgdGhlIGRvY3VtZW50LlxuXG4gICAgICBzdW0gPSBjcnlwdG8uY3JlYXRlSGFzaCAnc2hhMjU2J1xuICAgICAgc3VtLnVwZGF0ZSBKU09OLnN0cmluZ2lmeSBtb2RlbFxuICAgICAgaWQgPSBzdW0uZGlnZXN0ICdoZXgnXG4gICAgICBtb2RlbC5jb21tZW50X2lkID0gaWRcblxuV2hlbiBkZWxldGluZywgd2UgY2FuIHVzZSB0aGUgYGNvbW1lbnRgIHZhbHVlIHNpbmNlIGl0IGRvZXNuJ3QgaGF2ZSB0byBiZSB1bmlxdWUgZXZlbiBpZiB3ZSBjaGFuZ2UgdGhlIHJlY29yZC5cbldoZW4gY3JlYXRpbmcgZG9jdW1lbnRzIHdpdGggZGlmZmVyZW50IElEcywgd2VsbCwgdXNlIHRoZSBjb21wdXRlZCBJRC5cblxuICAgICAgbW9kZWwuX2lkID0gaWYgdXNlX2RlbGV0ZSB0aGVuIG1vZGVsLmNvbW1lbnQgZWxzZSBpZFxuXG5MZXQncyBnZXQgc3RhcnRlZC5cblxuICAgICAgZGVidWcgXCJHb2luZyB0byBpbmplY3RcIiwgbW9kZWxcblxuQ3JlYXRlIHRoZSB0YXJnZXQgZGF0YWJhc2UgaWYgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0LlxuXG4gICAgICB0YXJnZXQgPSBuZXcgUG91Y2hEQiBcIiN7cHJlZml4X3RhcmdldH0vI3tuYW1lfVwiLCBza2lwX3NldHVwOiBmYWxzZVxuICAgICAgeWllbGQgdGFyZ2V0LmluZm8oKVxuICAgICAgdGFyZ2V0LmNsb3NlKClcblxuV2hlbiB1c2luZyB0aGUgZGVsZXRpb24gbWV0aG9kLCBmaXJzdCBkZWxldGUgdGhlIGV4aXN0aW5nIHJlcGxpY2F0aW9uIGRvY3VtZW50LlxuXG4gICAgICBpZiB1c2VfZGVsZXRlXG4gICAgICAgIHtfcmV2fSA9IHlpZWxkIHJlcGxpY2F0b3JcbiAgICAgICAgICAuZ2V0IG1vZGVsLl9pZFxuICAgICAgICAgIC5jYXRjaCAoZXJyb3IpIC0+IHt9XG4gICAgICAgIHlpZWxkIHJlcGxpY2F0b3IucmVtb3ZlIG1vZGVsLl9pZCwgX3JldiBpZiBfcmV2P1xuXG5HaXZlIENvdWNoREIgc29tZSB0aW1lIHRvIGJyZWF0aC5cblxuICAgICAgeWllbGQgc2xlZXAgZGVsYXlcblxuVXBkYXRlIHRoZSByZXBsaWNhdGlvbiBkb2N1bWVudC5cblxuICAgICAge19yZXZ9ID0geWllbGQgcmVwbGljYXRvclxuICAgICAgICAuZ2V0IG1vZGVsLl9pZFxuICAgICAgICAuY2F0Y2ggKGVycm9yKSAtPiB7fVxuXG4gICAgICBkb2MgPSB7fVxuICAgICAgZG9jLl9yZXYgPSBfcmV2IGlmIF9yZXY/XG4gICAgICBmb3Igb3duIGssdiBvZiBtb2RlbFxuICAgICAgICBkb2Nba10gPSB2XG5cbiAgICAgIGRlYnVnICdDcmVhdGluZyByZXBsaWNhdGlvbicsIGRvY1xuXG4gICAgICB5aWVsZCByZXBsaWNhdG9yXG4gICAgICAgIC5wdXQgZG9jXG4gICAgICAgIC5jYXRjaCAoZXJyb3IpIC0+XG4gICAgICAgICAgZGVidWcuZXJyb3IgXCJwdXQgI3ttb2RlbC5faWR9XCIsIGVycm9yXG5cbkNhdGNoIDQwMyBlcnJvcnMgYXMgdGhleSBpbmRpY2F0ZSB0aGUgc3RhdHVzIHdhcyB1cGRhdGVkIGJ5IENvdWNoREIgKHRvbyBmYXN0IGZvciB1cyB0byBzZWUpLlxuXG4gICAgICAgICAgaWYgZXJyb3Iuc3RhdHVzPyBhbmQgZXJyb3Iuc3RhdHVzIGlzIDQwM1xuICAgICAgICAgICAgZGVidWcgXCJSZXBsaWNhdGlvbiBhbHJlYWR5IHN0YXJ0ZWRcIlxuICAgICAgICAgICAgcmV0dXJuXG5cblJlcG9ydCBhbGwgb3RoZXIgZXJyb3JzLlxuXG4gICAgICAgICAgZGVidWcuZXJyb3IgXCJSZXBsaWNhdGlvbiBmcm9tICN7bW9kZWwuc291cmNlfSBmYWlsZWQuXCIsIGVycm9yXG4gICAgICAgICAgUHJvbWlzZS5yZWplY3QgZXJyb3JcblxuR2l2ZSBDb3VjaERCIHNvbWUgdGltZSB0byBicmVhdGguXG5cbiAgICAgIHlpZWxkIHNsZWVwIGRlbGF5XG5cbkxvZyB0aGUgc3RhdHVzIG9mIHRoZSByZXBsaWNhdG9yXG5cbiAgICAgIGRvYyA9IHlpZWxkIHJlcGxpY2F0b3JcbiAgICAgICAgLmdldCBtb2RlbC5faWRcbiAgICAgICAgLmNhdGNoIChlcnJvcikgLT4ge31cblxuICAgICAgZGVidWcgJ1JlcGxpY2F0aW9uIHN0YXR1cycsIGRvY1xuICAgICAgcmVwbGljYXRvci5jbG9zZSgpXG4gICAgICByZXR1cm5cblxuVG9vbGJveFxuPT09PT09PVxuXG4gICAgUG91Y2hEQiA9IHJlcXVpcmUgJ2NjbnE0LXBvdWNoZGInXG4gICAgICAucGx1Z2luIHJlcXVpcmUgJ3BvdWNoZGItcmVwbGljYXRpb24nXG5cbiAgICBzbGVlcCA9ICh0aW1lb3V0KSAtPiBuZXcgUHJvbWlzZSAocmVzb2x2ZSkgLT4gc2V0VGltZW91dCByZXNvbHZlLCB0aW1lb3V0XG4gICAgY3J5cHRvID0gcmVxdWlyZSAnY3J5cHRvJ1xuICAgIHVybCA9IHJlcXVpcmUgJ3VybCdcbiAgICBwa2cgPSByZXF1aXJlICcuL3BhY2thZ2UuanNvbidcbiAgICBkZWJ1ZyA9IChyZXF1aXJlICd0YW5naWJsZScpIHBrZy5uYW1lXG4iXX0=
//# sourceURL=/srv/home/stephane/Artisan/Managed/Telecoms/frantic-team/index.coffee.md